<!DOCTYPE html>
<head>
    <title>
        KoalaWork
    </title>
    <link rel="stylesheet" type="text/css" href="/css/styles.css">
</head>
<body>
    <div class="header">KoalaWork</div>
    <h1>Freelancing Koalas In Your Area</h1>
    <div>
        <img src="https://images.unsplash.com/photo-1560819355-75e9819b2358?q=80&w=2265&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"/>
        <p> Koala Bob</p>
        <img src="https://images.unsplash.com/photo-1597151498177-6014a24575a0?q=80&w=2340&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"/>
        <p> Koala Jane</p>
        <img id="your-photo" src="/images/question-mark.png" />
        <p id="your-name"> Your profile here!</p>
        <button id="use-token-button">Use access token to get profile info</button>
    </div>
    <script>
        const button = document.getElementById('use-token-button')
        button.addEventListener('click', async _ => {
        try {     
            const response = await fetch("https://oauth-demo-2-ws.onrender.com/get-resource", {
            method: 'POST',
            headers: {
                "Authorization": 'Bearer I_AM_AN_ACCESS_TOKEN_12345',
                "Content-Type": "application/json",
            }
            });
            const data = await response.json();
            const profileImgElement = document.getElementById('your-photo')
            const nameElement = document.getElementById('your-name')
            nameElement.innerHTML = data.name
            profileImgElement.setAttribute("src", data.photo);


        } catch(err) {
            console.error(`Error: ${err}`);
        }
    })
    </script>
    

</body>
</html>
